<html>
<head>

    <title>Add Title Here</title>

    <script type="text/javascript"
	    src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
    <script type="text/javascript"></script>

</head>

<body>

    <div id="vizContainer"></div>
    <div style="margin:auto">
        <button id = "exportPDF">Generate PDF</button>
        <button id = "exportImage">Generate Image</button>
    </div>

    <script >
        
console.log('Is this working?');
let viz;

//Add Share Link to Tableau Public in here
const url = "https://public.tableau.com/views/SampleDashboard_16760181553310/HomePage?:language=en-US&publish=yes&:display_count=n&:origin=viz_share_link";

const vizContainer = document.getElementById('vizContainer');

            const options = {
                hideTabs: true,
                height: 1600,
                width: 1280,
                onFirstInteraction: function() {
                    workbook = viz.getWorkbook();
                    activeSheet = workbook.getActiveSheet();
                }
            };
            
            //create a function to generate the viz element
            function initViz() {
                viz = new tableau.Viz(vizContainer, url, options);
            }
            
            // run the initViz function when the page loads
            document.addEventListener("DOMContentLoaded", initViz);
            
            const exportPDF = document.getElementById('exportPDF');
            const exportImage = document.getElementById('exportImage');
            
            
            //click on the pdf button to generate pdf of dashboard
            function generatePDF() {
                viz.showExportPDFDialog()
            }
            
            exportPDF.addEventListener("click", function () {
                generatePDF();
                });
            
            //click on image to generate image of dashboard
            function generateImage() {
                viz.showExportImageDialog()
            }
            
            exportImage.addEventListener("click", function () {
                generateImage();
                });
    </script>

</body>

</html>
